<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COMP-1510-MUD Flowchart</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --background-color: #1e1e1e;
            --container-bg: #2d2d2d;
            --text-color: #e0e0e0;
            --heading-color: #58a6ff;
            --border-color: #444;
            --accent-color: #58a6ff;
            --section-bg: #333;
            --note-bg: rgba(88, 166, 255, 0.1);
            --sidebar-width: 240px;
            --header-height: 60px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .layout {
            display: flex;
        }

        .sidebar {
            width: var(--sidebar-width);
            position: fixed;
            height: 100vh;
            background-color: var(--container-bg);
            padding: 20px 0;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
            z-index: 100;
            overflow-y: auto;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 0 20px 15px;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .main-content {
            margin-left: var(--sidebar-width);
            width: calc(100% - var(--sidebar-width));
            padding: 0;
            transition: margin 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px;
        }

        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
                width: 100%;
            }

            .menu-toggle {
                display: block;
            }
        }

        header {
            position: relative;
            padding: var(--header-height) 0 20px;
            text-align: center;
            border-bottom: 2px solid var(--accent-color);
            margin-bottom: 30px;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: var(--section-bg);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: var(--accent-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s;
            z-index: 10;
        }

        .theme-toggle:hover {
            background-color: var(--accent-color);
            color: var(--background-color);
            transform: rotate(30deg);
        }

        .menu-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: var(--section-bg);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            color: var(--accent-color);
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            z-index: 1000;
            transition: all 0.3s;
        }

        h1,
        h2,
        h3 {
            color: var(--heading-color);
            margin-top: 1.8em;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.5em;
        }

        h1 {
            text-align: center;
            font-size: 2.2em;
            margin-bottom: 30px;
            border-bottom: none;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        h2 {
            font-size: 1.8em;
            margin-top: 50px;
            display: flex;
            align-items: center;
            border-top: 1px solid var(--border-color);
            padding-top: 20px;
        }

        h2 i {
            margin-right: 12px;
            font-size: 0.9em;
        }

        .diagram-container {
            position: relative;
            margin: 40px 0 60px;
            padding: 20px 0 0;
            border-radius: 10px;
            background-color: var(--section-bg);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .diagram-title {
            position: absolute;
            top: -15px;
            left: 20px;
            background-color: var(--accent-color);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
            color: var(--background-color);
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .mermaid {
            background-color: transparent;
            padding: 10px 20px 20px;
            border-radius: 0 0 10px 10px;
            overflow-x: auto;
            transition: all 0.3s ease;
        }

        .description {
            margin: 25px 0;
            line-height: 1.6;
            background-color: var(--section-bg);
            padding: 25px;
            border-radius: 10px;
            border-left: 5px solid var(--accent-color);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            font-size: 1.05em;
        }

        .note {
            margin: 20px 0;
            padding: 15px 20px 15px 35px;
            border-radius: 8px;
            background-color: var(--note-bg);
            position: relative;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .note::before {
            content: '\f05a';
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            position: absolute;
            left: 12px;
            top: 15px;
            color: var(--accent-color);
            font-size: 1em;
        }

        .diagram-controls {
            display: flex;
            margin: 10px 20px;
            justify-content: flex-end;
            gap: 10px;
        }

        .diagram-controls button {
            background-color: var(--section-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 6px 12px;
            cursor: pointer;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.2s;
        }

        .diagram-controls button:hover {
            background-color: var(--accent-color);
            color: var(--background-color);
        }

        .nav-tabs {
            display: flex;
            flex-direction: column;
            margin: 0;
            padding: 0;
            list-style: none;
        }

        .nav-tabs li {
            margin-bottom: 5px;
        }

        .nav-tabs li a {
            display: block;
            padding: 10px 20px;
            text-decoration: none;
            color: var(--text-color);
            border-left: 3px solid transparent;
            transition: all 0.3s;
        }

        .nav-tabs li a.active {
            background-color: var (--section-bg);
            border-left: 3px solid var(--accent-color);
            color: var(--accent-color);
            font-weight: bold;
        }

        .nav-tabs li a:hover:not(.active) {
            background-color: rgba(88, 166, 255, 0.1);
            border-left: 3px solid rgba(88, 166, 255, 0.5);
        }

        footer {
            margin-top: 50px;
            text-align: center;
            padding: 20px;
            border-top: 1px solid var(--border-color);
            font-size: 0.9em;
            color: var(--text-color);
            opacity: 0.7;
        }

        .game-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }

        .info-card {
            background-color: var(--section-bg);
            padding: 20px;
            border-radius: 10px;
            border-top: 4px solid var(--accent-color);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }

        .info-card h3 {
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
            color: var(--accent-color);
            font-size: 1.3em;
        }

        .info-card ul {
            padding-left: 20px;
        }

        .info-card li {
            margin-bottom: 8px;
        }

        .key-control {
            display: inline-block;
            background-color: var(--container-bg);
            padding: 2px 10px;
            border-radius: 4px;
            font-family: monospace;
            font-weight: bold;
            margin: 0 5px;
        }

        /* Light theme */
        body.light-theme {
            --background-color: #f5f5f5;
            --container-bg: #ffffff;
            --text-color: #333333;
            --heading-color: #0066cc;
            --border-color: #dddddd;
            --accent-color: #0066cc;
            --section-bg: #f8f9fa;
            --note-bg: rgba(0, 102, 204, 0.1);
        }

        /* Print styles */
        @media print {
            body {
                background-color: white;
                color: black;
            }

            .sidebar,
            .menu-toggle,
            .theme-toggle {
                display: none;
            }

            .main-content {
                margin-left: 0;
                width: 100%;
            }

            .container {
                max-width: 100%;
                padding: 0;
            }

            .diagram-container {
                box-shadow: none;
                break-inside: avoid;
            }

            .diagram-controls {
                display: none;
            }

            .description,
            .note {
                background-color: white;
                border-left-color: #0066cc;
                box-shadow: none;
            }

            .diagram-title {
                color: black;
                background-color: white;
                border: 1px solid #0066cc;
            }

            .game-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <button class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </button>

    <div class="layout">
        <nav class="sidebar" id="sidebar">
            <div>
                <h3>Navigation</h3>
            </div>
            <ul class="nav-tabs" id="diagramTabs">
                <li><a href="#overview" class="active">Game Overview</a></li>
                <li><a href="#arch">System Architecture</a></li>
                <li><a href="#gameflow">Game Flow</a></li>
                <li><a href="#gameloop">Game Loop</a></li>
                <li><a href="#rendering">3D Rendering</a></li>
                <li><a href="#player">Player Controls</a></li>
                <li><a href="#interaction">Interaction</a></li>
                <li><a href="#entities">Entity Systems</a></li>
                <li><a href="#dataflow">Data Flow</a></li>
                <li><a href="#modules">Module Structure</a></li>
            </ul>
        </nav>

        <div class="main-content">
            <div class="container">
                <header>
                    <h1>Paradox v(-1.0)</h1>
                    <button class="theme-toggle" id="themeToggle">
                        <i class="fas fa-sun"></i>
                    </button>
                </header>

                <div class="description">
                    <p><strong>Paradox v(-1.0)</strong> is a terminal-based 3D dungeon crawler implemented in Python
                        using
                        the curses library. The game features a raycasting engine similar to classic games like
                        Wolfenstein 3D, providing a pseudo-3D first-person perspective within a terminal window</p>
                </div>

                <div class="game-info">
                    <div class="info-card">
                        <h3><i class="fas fa-gamepad"></i> How to Play</h3>
                        <ul>
                            <li><span class="key-control">W</span><span class="key-control">A</span><span
                                    class="key-control">S</span><span class="key-control">D</span> - Move through the
                                dungeon</li>
                            <li><span class="key-control">←</span><span class="key-control">→</span> - Turn left/right
                            </li>
                            <li><span class="key-control">E</span> - Interact with doors and objects</li>
                            <li><span class="key-control">Space</span> - Attack/shoot</li>
                            <li><span class="key-control">M</span> - Toggle map view</li>
                            <li><span class="key-control">ESC</span> - Return to menu</li>
                        </ul>
                    </div>
                    <div class="info-card">
                        <h3><i class="fas fa-trophy"></i> Game Objectives</h3>
                        <ul>
                            <li>Navigate through procedurally generated dungeon levels</li>
                            <li>Defeat enemies using your fireballs!</li>
                            <li>Find doors and stairs to progress to new areas</li>
                            <li>Survive.</li>
                        </ul>
                    </div>
                </div>

                <div class="note">
                    <p><strong>Navigation:</strong> Use the sidebar to explore different aspects of the game
                        architecture. Each diagram has controls to zoom in/out or save as PNG.</p>
                </div>

                <div class="diagram-container" id="overview">
                    <div class="diagram-title">Game Overview</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        flowchart TD
                        Start([Game Start]) --> Menu[Main Menu]
                        Menu -->|Start Game| Init[Initialize Game World]
                        Menu -->|Instructions| Help[View Instructions]
                        Menu -->|Credits| Credits[View Credits]
                        Menu -->|Exit| End([Exit Game])

                        Help --> Menu
                        Credits --> Menu

                        Init --> GameLoop([Game Loop])

                        subgraph Core["Core Gameplay"]
                        GameLoop -->|Every Frame| Input[Process Input]
                        Input --> Update[Update Game State]
                        Update --> Render[Render 3D World]
                        Render --> GameLoop
                        end

                        Input -->|Q| Menu
                        Input -->|WASD| Movement[Move Player]
                        Input -->|Arrows| Rotation[Rotate View]
                        Input -->|E| Interact[Interact with Objects]
                        Input -->|Space| Combat[Attack/Shoot]

                        Movement --> Collide{Collision?}
                        Collide -->|Yes| StayInPlace[Prevent Movement]
                        Collide -->|No| UpdatePos[Update Position]

                        Interact --> Door{Door?}
                        Door -->|Yes| NewArea[Enter New Area]
                        Door -->|No| Object{Interactive?}
                        Object -->|Yes| Effect[Trigger Effect]

                        classDef menu fill:#58a6ff,stroke:#333,stroke-width:2px,color:white,font-weight:bold
                        classDef action fill:#4a9e5e,stroke:#333,stroke-width:1px,color:white
                        classDef decision fill:#d67c3b,stroke:#333,stroke-width:1px,color:white

                        class Start,End,GameLoop menu
                        class Menu,Init,Help,Credits menu
                        class Input,Update,Render,Movement,Rotation,Interact,Combat action
                        class Collide,Door,Object decision
                    </div>
                </div>

                <div class="diagram-container" id="arch">
                    <div class="diagram-title">System Architecture</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        graph TD
                        classDef mainModule fill:#58a6ff,stroke:#333,stroke-width:2px,color:white,font-weight:bold
                        classDef supportModule fill:#4a9e5e,stroke:#333,stroke-width:1px,color:white
                        classDef dataModule fill:#d67c3b,stroke:#333,stroke-width:1px,color:white
                        classDef renderModule fill:#c35f5f,stroke:#333,stroke-width:1px,color:white

                        Game[game.py] --> Player[player.py]
                        Game --> Renderer[renderer.py]
                        Game --> Map[map.py]
                        Game --> Menu[menu.py]
                        Game --> UI[ui.py]
                        Game --> Entities[entities.py]

                        Player --> Map
                        Renderer --> Map
                        Renderer --> Entities
                        UI --> Entities

                        Map -.-> MapData[Map Data]
                        Entities -.-> EntityData[Entity Data]
                        UI -.-> FireFrames[Animation Frames]

                        class Game mainModule
                        class Player,Entities supportModule
                        class Map,MapData dataModule
                        class Renderer,UI renderModule

                        subgraph Core Game Logic
                        Game
                        Player
                        Entities
                        end

                        subgraph Rendering Systems
                        Renderer
                        UI
                        FireFrames
                        end

                        subgraph World Data
                        Map
                        MapData
                        EntityData
                        end

                        subgraph User Interface
                        Menu
                        end
                    </div>
                </div>

                <div class="diagram-container" id="gameflow">
                    <div class="diagram-title">Game Flow</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        flowchart TD
                        Start([Program Start]) --> InitTerm[Initialize Terminal]
                        InitTerm --> InitCurses[Setup Curses]
                        InitCurses --> DisplayMenu[Display Main Menu]

                        DisplayMenu --> MenuChoice{User Selection}
                        MenuChoice -->|Start Game| InitGame[Initialize Game]
                        MenuChoice -->|Instructions| ShowInstructions[Display Instructions]
                        MenuChoice -->|Credits| ShowCredits[Display Credits]
                        MenuChoice -->|Exit| QuitProgram([End Program])

                        ShowInstructions --> DisplayMenu
                        ShowCredits --> DisplayMenu

                        InitGame --> LoadAssets[Load Game Assets]
                        LoadAssets --> CreatePlayer[Create Player Entity]
                        CreatePlayer --> LoadMap[Load Game Map]
                        LoadMap --> SpawnEnemies[Spawn Enemies]
                        SpawnEnemies --> GameLoop[Enter Game Loop]

                        GameLoop --> ProcessInput[Process User Input]
                        ProcessInput --> CheckQuit{Quit?}
                        CheckQuit -->|Yes| CleanupGame[Cleanup Resources]
                        CleanupGame --> DisplayMenu
                        CheckQuit -->|No| GameIteration[Continue Game Loop]
                        GameIteration --> GameLoop

                        classDef startNode fill:#58a6ff,stroke:#333,stroke-width:2px,color:white,font-weight:bold
                        classDef processNode fill:#4a9e5e,stroke:#333,stroke-width:1px,color:white
                        classDef decisionNode fill:#d67c3b,stroke:#333,stroke-width:1px,color:white
                        classDef endNode fill:#c35f5f,stroke:#333,stroke-width:1px,color:white

                        class Start,QuitProgram startNode
                        class MenuChoice,CheckQuit decisionNode
                        class GameLoop,ProcessInput processNode
                        class DisplayMenu startNode
                    </div>
                </div>

                <div class="diagram-container" id="gameloop">
                    <div class="diagram-title">Game Loop</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        flowchart TD
                        GameLoop([Game Loop Start]) --> CalcDeltaTime[Calculate Delta Time]
                        CalcDeltaTime --> ProcessInput[Process Keyboard Input]
                        ProcessInput --> CheckQuit{Quit Requested?}
                        CheckQuit -->|Yes| EndGameLoop([Return to Menu])
                        CheckQuit -->|No| CheckMode{Map Mode?}

                        CheckMode -->|Yes| RenderMap[Render Full Map View]
                        CheckMode -->|No| UpdatePlayer[Update Player Position]

                        UpdatePlayer --> CheckShoot{Shoot Pressed?}
                        CheckShoot -->|Yes| HandleShooting[Create Projectile & Animation]
                        CheckShoot -->|No| SkipShooting[Skip Shooting Logic]

                        HandleShooting --> UpdateEntities[Update All Entities]
                        SkipShooting --> UpdateEntities

                        UpdateEntities --> CheckInteract{Interact Pressed?}
                        CheckInteract -->|Yes| HandleInteraction[Process Interaction]
                        CheckInteract -->|No| SkipInteraction[Skip Interaction]

                        HandleInteraction --> PrepareRender[Clear Screen]
                        SkipInteraction --> PrepareRender

                        RenderMap --> DrawUI[Draw UI Elements]
                        PrepareRender --> Render3D[Render 3D World View]
                        Render3D --> DrawUI

                        DrawUI --> UpdateScreen[Update Screen Buffer]
                        UpdateScreen --> CapFrameRate[Sleep to Cap Frame Rate]
                        CapFrameRate --> GameLoop

                        subgraph Input Processing
                        ProcessInput
                        CheckQuit
                        end

                        subgraph Rendering Pipeline
                        PrepareRender
                        Render3D
                        RenderMap
                        DrawUI
                        UpdateScreen
                        end

                        subgraph Game State Updates
                        UpdatePlayer
                        UpdateEntities
                        HandleInteraction
                        HandleShooting
                        end

                        classDef loopNode fill:#58a6ff,stroke:#333,stroke-width:2px,color:white,font-weight:bold
                        classDef processNode fill:#4a9e5e,stroke:#333,stroke-width:1px,color:white
                        classDef decisionNode fill:#d67c3b,stroke:#333,stroke-width:1px,color:white
                        classDef renderNode fill:#c35f5f,stroke:#333,stroke-width:1px,color:white

                        class GameLoop,EndGameLoop loopNode
                        class CheckQuit,CheckMode,CheckShoot,CheckInteract decisionNode
                        class Render3D,RenderMap,DrawUI,UpdateScreen renderNode
                        class UpdatePlayer,UpdateEntities,HandleShooting,HandleInteraction processNode
                    </div>
                </div>

                <div class="diagram-container" id="rendering">
                    <div class="diagram-title">3D Rendering Pipeline</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        flowchart TD
                        RenderWorld([Render World]) --> GetDimensions[Get Screen Dimensions]
                        GetDimensions --> SetFOV[Set Field of View]
                        SetFOV --> ClearScreen[Clear Screen Buffer]

                        ClearScreen --> DrawBackground[Draw Sky and Floor]
                        DrawBackground --> InitRays[Initialize Raycasting]

                        InitRays --> CastingLoop[For Each Screen Column]
                        CastingLoop --> CalcRayAngle[Calculate Ray Angle]
                        CalcRayAngle --> CastRay[Cast Ray Into Scene]

                        CastRay --> DetectWall{Hit Wall?}
                        DetectWall -->|No| MaxDistance[Reached Max Distance]
                        DetectWall -->|Yes| RecordHit[Record Wall Data]
                        MaxDistance --> NextColumn{More Columns?}
                        RecordHit --> NextColumn

                        NextColumn -->|Yes| CastingLoop
                        NextColumn -->|No| PrepEntities[Prepare Entity Rendering]

                        PrepEntities --> EntityLoop[For Each Entity]
                        EntityLoop --> CalcEntityPos[Calculate Screen Position]
                        CalcEntityPos --> CheckVisible{In View?}

                        CheckVisible -->|No| NextEntity{More Entities?}
                        CheckVisible -->|Yes| EntityType{Entity Type?}
                        EntityType -->|Projectile| RenderProjectile[Render Projectile]
                        EntityType -->|Enemy| RenderEnemy[Render Enemy]

                        RenderProjectile --> NextEntity
                        RenderEnemy --> NextEntity

                        NextEntity -->|Yes| EntityLoop
                        NextEntity -->|No| DrawMinimap[Draw Minimap]

                        DrawMinimap --> DrawStatusBar[Draw Status Bar]
                        DrawStatusBar --> FinishRender([Complete Rendering])

                        subgraph "Ray Casting Process"
                        InitRays
                        CastingLoop
                        CalcRayAngle
                        CastRay
                        DetectWall
                        RecordHit
                        MaxDistance
                        NextColumn
                        end

                        subgraph "Entity Rendering"
                        PrepEntities
                        EntityLoop
                        CalcEntityPos
                        CheckVisible
                        EntityType
                        RenderProjectile
                        RenderEnemy
                        NextEntity
                        end

                        classDef startEndNode fill:#58a6ff,stroke:#333,stroke-width:2px,color:white,font-weight:bold
                        classDef processNode fill:#4a9e5e,stroke:#333,stroke-width:1px,color:white
                        classDef decisionNode fill:#d67c3b,stroke:#333,stroke-width:1px,color:white
                        classDef renderNode fill:#c35f5f,stroke:#333,stroke-width:1px,color:white

                        class RenderWorld,FinishRender startEndNode
                        class DetectWall,CheckVisible,EntityType,NextColumn,NextEntity decisionNode
                        class DrawBackground,RecordHit,RenderProjectile,RenderEnemy,DrawMinimap,DrawStatusBar renderNode
                        class CastingLoop,EntityLoop,CalcRayAngle,CastRay,CalcEntityPos processNode
                    </div>
                </div>

                <div class="diagram-container" id="entities">
                    <div class="diagram-title">Entity Management System</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        flowchart TD
                        A[Update Entities] --> B[Update Projectiles]
                        B --> C[Start Projectile Loop]
                        C --> D{Lifetime Expired?}
                        D -- Yes --> E[Mark Projectile for Removal]
                        D -- No --> F[Update Projectile Position]
                        F --> G{Collision?}
                        G -- Yes --> E
                        G -- No --> H[Check Enemy Hits]
                        E --> I{More Projectiles?}
                        H --> I
                        I -- Yes --> C
                        I -- No --> J[Update Enemies]

                        J --> K[Start Enemy Loop]
                        K --> L{Is Enemy Dead?}
                        L -- Yes --> M{More Enemies?}
                        L -- No --> N[Calculate Distance to Player]
                        N --> O[Check Line of Sight]
                        O --> P[Determine AI State]
                        P --> Q[Update Enemy State]
                        Q --> R{Time to Move?}
                        R -- No --> M
                        R -- Yes --> S{Current State?}
                        S -- Idle --> T[Perform Random Movement]
                        S -- Chase --> U[Chase Player]
                        S -- Attack --> V[Execute Attack Pattern]
                        T --> M
                        U --> M
                        V --> M

                        M -- Yes --> K
                        M -- No --> W[Cleanup Marked Entities]
                        W --> X[Entities Updated]

                        subgraph "Projectile Management"
                        B
                        C
                        D
                        E
                        F
                        G
                        H
                        I
                        end

                        subgraph "Enemy Management"
                        J
                        K
                        L
                        N
                        O
                        P
                        Q
                        R
                        S
                        T
                        U
                        V
                        M
                        W
                        X
                        end

                        classDef startEnd fill:#58a6ff,stroke:#333,stroke-width:2px,color:white,font-weight:bold;
                        classDef process fill:#4a9e5e,stroke:#333,stroke-width:1px,color:white;
                        classDef decision fill:#d67c3b,stroke:#333,stroke-width:1px,color:white;
                        classDef cleanup fill:#c35f5f,stroke:#333,stroke-width:1px,color:white;

                        class A,X startEnd;
                        class D,G,L,R,S decision;
                        class F,H,N,O,P,Q,T,U,V process;
                        class W cleanup;
                    </div>
                </div>

                <div class="diagram-container" id="player">
                    <div class="diagram-title">Player Physics and Movement</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        flowchart TD
                        %% Start Node
                        A[Update Player]

                        %% Force Calculation
                        subgraph ForceCalculation[Force Calculation]
                        B1[Get Active Keys]
                        B2[Calculate Movement Force]
                        B3[Calculate Rotation Force]
                        B4[Normalize Force Vectors]
                        end

                        %% Physics Simulation
                        subgraph PhysicsSimulation[Physics Simulation]
                        C1[Apply Acceleration]
                        C2[Calculate Friction]
                        C3[Apply Friction]
                        C4[Enforce Maximum Speed]
                        end

                        %% Collision Response
                        subgraph CollisionResponse[Collision Response]
                        D1[Calculate New Position]
                        D2{Would Collide?}
                        D3[Handle Collision]
                        D4{X-axis Clear?}
                        D5[Slide Along Y-axis]
                        D6{Y-axis Clear?}
                        D7[Slide Along X-axis]
                        D8[Stop Movement]
                        D9[Update Position]
                        end

                        %% Post Movement Adjustment
                        subgraph PostMovement[Post Movement Adjustment]
                        E1[Update Angle]
                        E2{Is Moving?}
                        E3[Update Head Bob]
                        E4[Decay Head Bob]
                        E5[Check Special Actions]
                        E6[Return Actions]
                        end

                        %% Flow Connections
                        A --> B1
                        B1 --> B2
                        B2 --> B3
                        B3 --> B4

                        B4 --> C1
                        C1 --> C2
                        C2 --> C3
                        C3 --> C4

                        C4 --> D1
                        D1 --> D2
                        D2 -- Yes --> D3
                        D2 -- No --> D9
                        D3 --> D4
                        D4 -- Yes --> D5
                        D4 -- No --> D6
                        D6 -- Yes --> D7
                        D6 -- No --> D8

                        D5 --> E1
                        D7 --> E1
                        D8 --> E1
                        D9 --> E1

                        E1 --> E2
                        E2 -- Yes --> E3
                        E2 -- No --> E4
                        E3 --> E5
                        E4 --> E5
                        E5 --> E6

                        %% Styling Classes
                        classDef startEnd fill:#58a6ff,stroke:#333,stroke-width:2px,color:white,font-weight:bold;
                        classDef process fill:#4a9e5e,stroke:#333,stroke-width:1px,color:white;
                        classDef decision fill:#d67c3b,stroke:#333,stroke-width:1px,color:white;
                        classDef physics fill:#c35f5f,stroke:#333,stroke-width:1px,color:white;

                        class A,E6 startEnd;
                        class D2,E2 decision;
                        class C1,C3,C4 physics;
                        class B2,B3,B4,C2,D1,E1,E3,E4,E5 process;
                    </div>
                </div>

                <div class="diagram-container" id="interaction">
                    <div class="diagram-title">Interaction System</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        flowchart TD
                        Start([Interaction]) --> DetectObject[Detect Nearby Object]
                        DetectObject --> ObjectType{Object Found?}
                        ObjectType -->|No| NoObject[Display Message]
                        ObjectType -->|Door| OpenDoor[Change Map]
                        ObjectType -->|Stairs| UseStairs[Display Message]
                        ObjectType -->|Wall| HitWall[Display Message]

                        NoObject --> End([Complete])
                        OpenDoor --> End
                        UseStairs --> End
                        HitWall --> End

                        classDef startEnd fill:#58a6ff,stroke:#333,stroke-width:2px,color:white,font-weight:bold
                        classDef process fill:#4a9e5e,stroke:#333,stroke-width:1px,color:white
                        classDef decision fill:#d67c3b,stroke:#333,stroke-width:1px,color:white
                        classDef action fill:#c35f5f,stroke:#333,stroke-width:1px,color:white

                        class Start,End startEnd
                        class ObjectType decision
                        class DetectObject process
                        class OpenDoor,UseStairs,HitWall,NoObject action
                    </div>
                </div>

                <div class="diagram-container" id="dataflow">
                    <div class="diagram-title">Data Flow Diagram</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        flowchart LR
                        UserInput([User Input]) -->|Keys & Commands| Game[Game Controller]
                        Game -->|Player Updates| Player[Player State]
                        Game -->|Render Request| Renderer[Renderer]
                        Game -->|Entity Updates| Entities[Entity Manager]
                        Game -->|Map Queries| Map[Map System]

                        Player -->|Position Data| Renderer
                        Player -->|Movement Commands| Physics[Physics System]
                        Player -->|Interaction| Map

                        Entities -->|Enemy Positions| Renderer
                        Entities -->|Projectile States| Renderer
                        Entities -->|Collision Queries| Map

                        Map -->|Terrain Data| Renderer
                        Map -->|Collision Results| Physics

                        Physics -->|Updated Position| Player
                        Physics -->|Collision Detection| Map

                        Renderer -->|Visual Output| TerminalDisplay([Terminal Display])

                        style UserInput fill:#58a6ff,stroke:#333,stroke-width:2px
                        style TerminalDisplay fill:#58a6ff,stroke:#333,stroke-width:2px

                        subgraph "Core Game State"
                        Game
                        Player
                        Entities
                        Map
                        end

                        subgraph "Processing Systems"
                        Physics
                        Renderer
                        end
                    </div>
                </div>

                <div class="diagram-container" id="modules">
                    <div class="diagram-title">Module Dependency Graph</div>
                    <div class="diagram-controls">
                        <button class="zoom-in"><i class="fas fa-search-plus"></i> Zoom In</button>
                        <button class="zoom-out"><i class="fas fa-search-minus"></i> Zoom Out</button>
                        <button class="save-png"><i class="fas fa-download"></i> Save as PNG</button>
                    </div>
                    <div class="mermaid">
                        flowchart TD
                        gamepy[game.py] --> menupy[menu.py]
                        gamepy --> rendererpy[renderer.py]
                        gamepy --> playerpy[player.py]
                        gamepy --> mappy[map.py]
                        gamepy --> uipy[ui.py]
                        gamepy --> entitiespy[entities.py]

                        uipy --> animfire["anim/hand/fire.py"]
                        rendererpy --> animfire
                        rendererpy --> entitiespy

                        playerpy -.-> mappy
                        entitiespy -.-> mappy

                        subgraph MainFlow["Main Game Flow"]
                        gamepy
                        menupy
                        end

                        subgraph GameSystems["Game Systems"]
                        playerpy
                        entitiespy
                        mappy
                        end

                        subgraph RenderingSystems["Rendering Systems"]
                        rendererpy
                        uipy
                        end

                        subgraph Assets["Asset Files"]
                        animfire
                        end

                        classDef mainFile fill:#58a6ff,stroke:#333,stroke-width:2px,color:white,font-weight:bold
                        classDef moduleFile fill:#4a9e5e,stroke:#333,stroke-width:1px,color:white
                        classDef assetFile fill:#d67c3b,stroke:#333,stroke-width:1px,color:white

                        class gamepy mainFile
                        class menupy,rendererpy,playerpy,mappy,uipy,entitiespy moduleFile
                        class animfire assetFile
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Mermaid with custom configuration
        mermaid.initialize({
            startOnLoad: true,
            theme: 'dark',
            fontFamily: 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif',
            themeVariables: {
                primaryColor: '#58a6ff',
                primaryTextColor: '#fff',
                primaryBorderColor: '#58a6ff',
                lineColor: '#999',
                secondaryColor: '#444',
                tertiaryColor: '#2d2d2d'
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis',
                rankSpacing: 100,
                nodeSpacing: 80,
                diagramPadding: 20
            },
            securityLevel: 'loose'
        });

        // Theme toggle functionality
        document.getElementById('themeToggle').addEventListener('click', function () {
            const body = document.body;
            const icon = this.querySelector('i');

            body.classList.toggle('light-theme');

            if (body.classList.contains('light-theme')) {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');

                // Reinitialize mermaid with light theme
                mermaid.initialize({
                    theme: 'neutral',
                    themeVariables: {
                        primaryColor: '#0066cc',
                        primaryTextColor: '#333',
                        primaryBorderColor: '#0066cc',
                        lineColor: '#666',
                    }
                });
            } else {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');

                // Reinitialize mermaid with dark theme
                mermaid.initialize({
                    theme: 'dark',
                    themeVariables: {
                        primaryColor: '#58a6ff',
                        primaryTextColor: '#fff',
                        primaryBorderColor: '#58a6ff',
                        lineColor: '#999',
                    }
                });
            }

            // Redraw all diagrams
            mermaid.init(undefined, document.querySelectorAll('.mermaid'));
        });

        // Mobile menu toggle
        document.getElementById('menuToggle').addEventListener('click', function () {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');

            const icon = this.querySelector('i');
            if (sidebar.classList.contains('active')) {
                icon.classList.remove('fa-bars');
                icon.classList.add('fa-times');
            } else {
                icon.classList.remove('fa-times');
                icon.classList.add('fa-bars');
            }
        });

        // Tab navigation
        document.querySelectorAll('#diagramTabs a').forEach(tab => {
            tab.addEventListener('click', function (e) {
                e.preventDefault();

                // Remove active class from all tabs
                document.querySelectorAll('#diagramTabs a').forEach(t => {
                    t.classList.remove('active');
                });

                // Add active class to clicked tab
                this.classList.add('active');

                // Get target ID
                const targetId = this.getAttribute('href').substring(1);

                // Scroll to target
                document.getElementById(targetId).scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });

                // On mobile, close the menu after clicking
                if (window.innerWidth <= 768) {
                    document.getElementById('sidebar').classList.remove('active');
                    const menuIcon = document.querySelector('#menuToggle i');
                    menuIcon.classList.remove('fa-times');
                    menuIcon.classList.add('fa-bars');
                }
            });
        });

        // Zoom and save functionality
        document.querySelectorAll('.diagram-controls .zoom-in').forEach(button => {
            button.addEventListener('click', function () {
                const container = this.closest('.diagram-container');
                const diagram = container.querySelector('.mermaid');
                const svg = diagram.querySelector('svg');

                if (svg) {
                    const currentWidth = parseInt(svg.getAttribute('width') || svg.getBBox().width);
                    const newWidth = currentWidth * 1.2;
                    svg.setAttribute('width', newWidth);
                }
            });
        });

        document.querySelectorAll('.diagram-controls .zoom-out').forEach(button => {
            button.addEventListener('click', function () {
                const container = this.closest('.diagram-container');
                const diagram = container.querySelector('.mermaid');
                const svg = diagram.querySelector('svg');

                if (svg) {
                    const currentWidth = parseInt(svg.getAttribute('width') || svg.getBBox().width);
                    const newWidth = currentWidth * 0.8;
                    svg.setAttribute('width', newWidth);
                }
            });
        });

        document.querySelectorAll('.diagram-controls .save-png').forEach(button => {
            button.addEventListener('click', function () {
                const container = this.closest('.diagram-container');
                const diagram = container.querySelector('.mermaid');
                const svg = diagram.querySelector('svg');
                const title = container.querySelector('.diagram-title').textContent;

                if (svg) {
                    // Create a canvas and draw SVG on it
                    const canvas = document.createElement('canvas');
                    const svgData = new XMLSerializer().serializeToString(svg);
                    const img = new Image();

                    img.onload = function () {
                        canvas.width = img.width;
                        canvas.height = img.height;
                        const ctx = canvas.getContext('2d');
                        ctx.fillStyle = '#333';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        ctx.drawImage(img, 0, 0);

                        // Create download link
                        const a = document.createElement('a');
                        a.download = `MUD-${title.replace(/\s+/g, '-')}.png`;
                        a.href = canvas.toDataURL('image/png');
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                    };

                    img.src = 'data:image/svg+xml;base64,' + btoa(unescape(encodeURIComponent(svgData)));
                }
            });
        });

        // Make diagrams responsive
        window.addEventListener('resize', function () {
            mermaid.init(undefined, document.querySelectorAll('.mermaid'));
        });
    </script>
</body>

</html>